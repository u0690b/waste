import{_ as y}from"./Admin-BLpyamjN.js";import{M as g}from"./MyInput-j_KuZLzo.js";import{d as v}from"./debounce-C93t8mDT.js";import{p as x}from"./pickBy-BHy1ZBuc.js";import"https://cdn.skypack.dev/file-saver@2.0.5";import{r as w,c as l,o as d,a as o,b as h,F as u,g as f,j as _,t as m,f as V,d as j,au as F}from"./app-C1PK1slr.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CyiJiHID.js";const I={metaInfo:{title:"Documents"},components:{MyInput:g},layout:y,props:{datas:Object,filters:[Object,Array],host:String},data(){return{form:{sh_type:[],...this.filters??{}},types:{reason_name:"Зөрчлийн төрөл",ac_name:"Аймаг нийслэл",sd_name:"Сум дүүрэг",bh_name:"Баг хороо",whois:"Хэлбэр",org:"Байгууллага",status_name:"Төлөв",reg_user:"Бүртгэсэн хүн",comf_user:"Шийдвэрлэсэн, Хуваарилагдсан",resolve_name:"Шийдвэрийн төрөл"}}},computed:{grantTotal(){return this.datas.map(e=>+e.niit).reduce((e,t)=>e+t,0)},tableData(){return this.combineCell(this.datas)}},watch:{form:{handler:v(function(){this.$inertia.get(this.route("admin.tailan"),x(this.form),{preserveState:!0})},150),deep:!0}},methods:{getSpan(e,t){let a=0,n=this.datas[e][t];for(let s=e;s<this.datas.length;s++)if(n==this.datas[s][t])a++;else return a},combineCell(e){for(let n in e[0])for(var t=0;t<e.length;){e[t][n+"span"]=1,e[t][n+"dis"]=!1;for(var a=t+1;a<=e.length-1&&(e[t][n]==e[a][n]&&e[t][n]!="");a++)e[t][n+"span"]++,e[t][n+"dis"]=!1,e[a][n+"span"]=1,e[a][n+"dis"]=!0;t=a}return e},save(){let e=[],t=[];const a=this.datas;for(const s of this.filters.sh_type)t.push(this.types[s]);t.push("niit"),e.push(t.join(","));for(const s of a){let p=[];for(const c of this.filters.sh_type)p.push('"'+(s[c]??" ")+'"');p.push(s.niit),e.push(p.join(","))}const n=new Blob(["\uFEFF"+e.join(`
`)],{encoding:"UTF-8",type:"text/csv;charset=utf-8;"});saveAs(n,"data.csv")}}},T={class:"m-auto mb-6"},B={class:"bg-white rounded shadow p-6"},D={class:"flex gap-4 mb-8 border-b"},M={class:"grid grid-cols-2 gap-x-4 justify-between"},S=["value"],N={class:""},U={class:"bg-white"},k={class:"table table-bordered border min-w-fit"},A={class:"font-bold"},E={class:"align-text-top"},O=["rowspan"],L={class:"border"},q={class:"font-bold"},z=["colspan"];function G(e,t,a,n,s,p){const c=w("MyInput");return d(),l("div",null,[o("div",T,[o("div",B,[t[6]||(t[6]=o("h1",{class:"mb-8 text-3xl font-bold"},"Тайлан",-1)),o("div",D,[h(c,{modelValue:s.form.start_at,"onUpdate:modelValue":t[0]||(t[0]=r=>s.form.start_at=r),type:"date",class:"w-40",label:"Эхлэх огноо"},null,8,["modelValue"]),h(c,{modelValue:s.form.end_at,"onUpdate:modelValue":t[1]||(t[1]=r=>s.form.end_at=r),type:"date",class:"w-40",label:"Дуусах огноо"},null,8,["modelValue"]),o("div",M,[(d(!0),l(u,null,f(s.types,(r,i)=>(d(),l("label",{key:i},[V(o("input",{"onUpdate:modelValue":t[2]||(t[2]=b=>s.form.sh_type=b),type:"checkbox",value:i},null,8,S),[[F,s.form.sh_type]]),j(" "+m(r),1)]))),128))]),o("button",{onClick:t[3]||(t[3]=(...r)=>p.save&&p.save(...r)),class:"rounded bg-orange-500 h-8 px-4 text-white"},"CSV файл татах")]),o("div",N,[o("div",U,[o("table",k,[o("thead",A,[o("tr",null,[(d(!0),l(u,null,f(s.form.sh_type,(r,i)=>(d(),l("td",{key:i,class:"px-1 border py-2"},m(s.types[r]),1))),128)),t[4]||(t[4]=o("td",{class:"px-1 py-2 border"},"Нийт",-1))])]),o("tbody",E,[(d(!0),l(u,null,f(p.tableData,r=>(d(),l("tr",{key:r},[(d(!0),l(u,null,f(s.form.sh_type,i=>(d(),l(u,null,[r[i+"dis"]?_("",!0):(d(),l("td",{key:i,rowspan:r[i+"span"],class:"border"},m(r[i]),9,O))],64))),256)),o("td",L,m(r.niit),1)]))),128))]),o("tfoot",null,[o("tr",q,[s.form.sh_type.length>1?(d(),l("td",{key:0,colspan:s.form.sh_type.length-1},null,8,z)):_("",!0),t[5]||(t[5]=o("td",null,"Нийт",-1)),o("td",null,m(p.grantTotal),1)])])])])])])])])}const Z=C(I,[["render",G],["__scopeId","data-v-60acf2f1"]]);export{Z as default};
