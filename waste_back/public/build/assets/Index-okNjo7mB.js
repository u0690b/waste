import{u as C,au as S,J as h,h as T,e as l,o as r,a,b as v,f as c,F as p,i as _,l as g,t as m,k as U,d as B,av as I}from"./app-CARJDBxm.js";import{_ as N}from"./Admin-CUPXhku5.js";import{M as y}from"./MyInput-DOnaYiOT.js";import{d as D}from"./debounce-BOY4wkUO.js";import"./pickBy-RZ_CIFXr.js";import M from"https://cdn.skypack.dev/file-saver@2.0.5";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./icon-512-vKo9cVLo.js";import"./index-CP857yun.js";const A={class:"m-auto mb-6"},E={class:"p-6 bg-white rounded shadow"},L={class:"flex gap-4 mb-8 border-b"},J={class:"grid justify-between grid-cols-3 gap-x-4"},$=["value"],q={class:""},z={class:"bg-white"},G={class:"table border table-bordered min-w-fit"},H={class:"font-bold"},K={class:"align-text-top"},P=["rowspan"],Q={class:"border"},R={class:"font-bold"},W=["colspan"],X=Object.assign({layout:N},{__name:"Index",props:{datas:Object,filters:[Object,Array],host:String},setup(x){const i=x,f={reason_name:"Зөрчлийн төрөл",ac_name:"Аймаг нийслэл",sd_name:"Сум дүүрэг",bh_name:"Баг хороо",whois:"Хэлбэр",org:"Байгууллага",status_name:"Төлөв",reg_user:"Бүртгэсэн хүн",comf_user:"Шийдвэрлэсэн",resolve_name:"Шийдвэрийн төрөл"},d=C({model:{...i.filters,per_page:i.datas.per_page}}).transform(t=>t.model);S(()=>{});const u=h(()=>[...i.filters.sh_type||[]]),w=h(()=>i.datas.map(t=>+t.niit).reduce((t,s)=>t+s,0)),V=h(()=>k([...i.datas]));function k(t){if(!t.length)return[];const s=u.value;for(const e of s){let o=0;for(;o<t.length;){t[o][e+"span"]=1,t[o][e+"dis"]=!1;let n=o+1;for(;n<t.length&&t[o][e]===t[n][e]&&t[o][e]!=="";)t[o][e+"span"]++,t[n][e+"span"]=1,t[n][e+"dis"]=!0,n++;o=n}}return t}function F(){let t=[],s=[];const e=i.datas;for(const n of u)s.push(f[n]);s.push("niit"),t.push(s.join(","));for(const n of e){let b=[];for(const j of u)b.push('"'+(n[j]??" ")+'"');b.push(n.niit),t.push(b.join(","))}const o=new Blob(["\uFEFF"+t.join(`
`)],{encoding:"UTF-8",type:"text/csv;charset=utf-8;"});M.saveAs(o,"data.csv")}return T(()=>d.model,D(()=>d.get("",{preserveState:!0}),150),{deep:!0}),(t,s)=>(r(),l("div",null,[a("div",A,[a("div",E,[s[5]||(s[5]=a("h1",{class:"mb-8 text-3xl font-bold"},"Тайлан",-1)),a("div",L,[v(y,{modelValue:c(d).model.start_at,"onUpdate:modelValue":s[0]||(s[0]=e=>c(d).model.start_at=e),type:"date",class:"w-40",label:"Эхлэх огноо"},null,8,["modelValue"]),v(y,{modelValue:c(d).model.end_at,"onUpdate:modelValue":s[1]||(s[1]=e=>c(d).model.end_at=e),type:"date",class:"w-40",label:"Дуусах огноо"},null,8,["modelValue"]),a("div",J,[(r(),l(p,null,_(f,(e,o)=>a("label",{key:o},[U(a("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=n=>c(d).model.sh_type=n),value:o},null,8,$),[[I,c(d).model.sh_type]]),B(m(e),1)])),64))]),a("button",{onClick:F,class:"h-8 px-4 text-white bg-orange-500 rounded"},"CSV файл татах")]),a("div",q,[a("div",z,[a("table",G,[a("thead",H,[a("tr",null,[(r(!0),l(p,null,_(u.value,(e,o)=>(r(),l("td",{key:o,class:"px-1 py-2 border"},m(f[e]),1))),128)),s[3]||(s[3]=a("td",{class:"px-1 py-2 border"},"Нийт",-1))])]),a("tbody",K,[(r(!0),l(p,null,_(V.value,e=>(r(),l("tr",{key:e},[(r(!0),l(p,null,_(u.value,o=>(r(),l(p,null,[e[o+"dis"]?g("",!0):(r(),l("td",{key:o,rowspan:e[o+"span"],class:"border"},m(e[o]),9,P))],64))),256)),a("td",Q,m(e.niit),1)]))),128))]),a("tfoot",null,[a("tr",R,[u.value.length>1?(r(),l("td",{key:0,colspan:u.value.length-1},null,8,W)):g("",!0),s[4]||(s[4]=a("td",null,"Нийт",-1)),a("td",null,m(w.value),1)])])])])])])])]))}}),re=O(X,[["__scopeId","data-v-cbd8adcb"]]);export{re as default};
